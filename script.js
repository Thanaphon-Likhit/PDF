document.getElementById("letterForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ unit: "mm", format: "a4" });

  const name = document.getElementById("name").value;
  const faculty = document.getElementById("faculty").value;
  const period = document.getElementById("period").value;
  const company = document.getElementById("company").value;
  const issuedate = document.getElementById("issuedate").value;

  // ‡∏ï‡∏£‡∏≤‡∏Ñ‡∏£‡∏∏‡∏ë (‡πÉ‡∏ä‡πâ emoji ‡πÅ‡∏ó‡∏ô‡πÉ‡∏ô PDF)
  doc.setFontSize(24);
  doc.text("ü¶Ö", 105, 25, { align: "center" });
  doc.setFontSize(18);
  doc.text("‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£", 105, 38, { align: "center" });
  doc.setFontSize(14);
  doc.text("(‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)", 105, 46, { align: "center" });

  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
  doc.setFontSize(16);
  let y = 65;
  const lines = [
    `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£: ${new Date(issuedate).toLocaleDateString("th-TH")}`,
    "",
    "‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏Ñ‡∏ì‡∏∞‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡∏î‡∏ó‡∏£‡∏≤‡∏ö",
    "‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏Ç‡∏≠‡∏•‡∏á‡∏ô‡∏≤‡∏°‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà",
    `\u00A0\u00A0\u00A0‡∏Å‡∏£‡∏∞‡∏ú‡∏° ${name} ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ${faculty} ‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4`,
    `‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${period}`,
    `‡∏ó‡∏≤‡∏á${company} ‡πÅ‡∏à‡πâ‡∏á‡∏ß‡πà‡∏≤ ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡∏°‡∏≤‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏ó‡∏≤‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ 11:00 ‡∏ô.`,
    "‡πÇ‡∏î‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå PDF ‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á 14:00 ‡∏ô.",
    "",
    "‡∏à‡∏∂‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡∏î‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤",
    "",
    "",
    "(‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠) ........................................................",
    `(${name})`,
    "‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ú‡∏π‡πâ‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠"
  ];

  doc.setFont("THSarabunNew", "normal");
  lines.forEach(line => {
    doc.text(line, 25, y);
    y += 10;
  });

  doc.save("‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç_‡∏Ç‡∏≠‡∏•‡∏á‡∏ô‡∏≤‡∏°‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô.pdf");
});
