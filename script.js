document.getElementById("letterForm").addEventListener("submit", (e) => {
  e.preventDefault();
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ unit: "mm", format: "a4" });

  const issuedate = document.getElementById("issuedate").value;
  const formattedDate = new Date(issuedate).toLocaleDateString("th-TH", {
    year: "numeric",
    month: "long",
    day: "numeric"
  });

  // р╕лр╕▒р╕зр╣Ар╕нр╕Бр╕кр╕▓р╕г
  doc.setFontSize(24);
  doc.text("ЁЯжЕ", 105, 25, { align: "center" });
  doc.setFontSize(18);
  doc.text("р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕гр╕▓р╕Кр╕Бр╕▓р╕г (р╣Ар╕нр╕Бр╕кр╕▓р╕гр╕кр╕│р╕Др╕▒р╕Н)", 105, 38, { align: "center" });

  doc.setFontSize(14);
  doc.text(`р╕зр╕▒р╕Щр╕Чр╕╡р╣И ${formattedDate}`, 170, 55, { align: "right" });

  // р╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╣Ар╕нр╕Бр╕кр╕▓р╕г
  const content = [
    "р╣Ар╕гр╕╡р╕вр╕Щ р╕Др╕Ур╕░р╕нр╕▓р╕Ир╕▓р╕гр╕вр╣М р╣Ар╕Юр╕╖р╣Ир╕нр╣Вр╕Ыр╕гр╕Фр╕Чр╕гр╕▓р╕Ъ",
    "р╣Ар╕гр╕╖р╣Ир╕нр╕З р╕Вр╕нр╕ер╕Зр╕Щр╕▓р╕бр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕Эр╕╢р╕Бр╕Зр╕▓р╕Щр╣Гр╕лр╕бр╣И",
    "",
    "р╕Бр╕гр╕░р╕Ьр╕б р╕Щр╕▓р╕в р╕Шр╕Щр╕Юр╕Щр╕Шр╣М р╕ер╕┤р╕Вр╕┤р╕Хр╕Ыр╕▒р╕Нр╕Нр╕▓р╕зр╕▒р╕Тр╕Щр╣М р╣Ар╕Ыр╣Зр╕Щр╕Щр╕▒р╕Бр╕ир╕╢р╕Бр╕йр╕▓ р╕Др╕Ур╕░ р╕кр╕▓р╕Шр╕▓р╕гр╕Ур╕кр╕╕р╕Вр╕ир╕▓р╕кр╕Хр╕гр╣М р╕кр╕▓р╕Вр╕▓ р╕нр╕▓р╕Кр╕╡р╕зр╕нр╕Щр╕▓р╕бр╕▒р╕вр╣Бр╕ер╕░р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в р╕Кр╕▒р╣Йр╕Щр╕Ыр╕╡р╕Чр╕╡р╣И 4",
    "р╕Ир╕░р╣Ар╕Вр╣Йр╕▓р╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╕Зр╕▓р╕Щ р╣Гр╕Щр╕зр╕▒р╕Щр╕Чр╕╡р╣И 10 р╕Юр╕др╕ир╕Ир╕┤р╕Бр╕▓р╕вр╕Щ 2568 р╕Цр╕╢р╕З 27 р╕Бр╕╕р╕бр╕ар╕▓р╕Юр╕▒р╕Щр╕Шр╣М 2569",
    "р╕Чр╕▓р╕Зр╕Ър╕гр╕┤р╕йр╕▒р╕Ч р╕Ыр╕╣р╕Щр╕Лр╕╡р╣Ар╕бр╕Щр╕Хр╣М (р╕Чр╣Ир╕▓р╕лр╕ер╕зр╕З) р╕Ир╕│р╕Бр╕▒р╕Ф р╣Бр╕Ир╣Йр╕Зр╕зр╣Ир╕▓ р╣Гр╕лр╣Йр╕Чр╕│р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕кр╣Ир╕Зр╕Хр╕▒р╕зр╕Эр╕╢р╕Бр╕Зр╕▓р╕Щр╕бр╕▓р╣Гр╕лр╕бр╣И",
    "р╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕Ир╕▓р╕Бр╕Хр╣Йр╕нр╕Зр╕кр╣Ир╕Зр╕Чр╕▓р╕Зр╕Ър╕гр╕┤р╕йр╕▒р╕Чр╕Юр╕гр╕╕р╣Ир╕Зр╕Щр╕╡р╣Й р╕Бр╣Ир╕нр╕Щр╣Ар╕зр╕ер╕▓ 11:00 р╕Щ. р╣Вр╕Фр╕вр╣Ар╕Ыр╣Зр╕Щр╣Др╕Яр╕ер╣М PDF р╕бр╕▓р╕Бр╣Ир╕нр╕Щ р╕кр╣Ир╕зр╕Щр╕Хр╕▒р╕зр╕Ир╕гр╕┤р╕Зр╣Гр╕лр╣Йр╕кр╣Ир╕З 14:00 р╕Щ.",
    "",
    "р╕Ир╕╢р╕Зр╣Ар╕гр╕╡р╕вр╕Щр╕бр╕▓р╣Ар╕Юр╕╖р╣Ир╕нр╣Вр╕Ыр╕гр╕Фр╕Юр╕┤р╕Ир╕▓р╕гр╕Ур╕▓",
    "",
    "",
    "р╕ер╕Зр╕Кр╕╖р╣Ир╕н ....................................................",
    "(р╕Щр╕▓р╕в р╕Шр╕Щр╕Юр╕Щр╕Шр╣М р╕ер╕┤р╕Вр╕┤р╕Хр╕Ыр╕▒р╕Нр╕Нр╕▓р╕зр╕▒р╕Тр╕Щр╣М)",
  ];

  doc.setFont("THSarabunNew", "normal");
  doc.setFontSize(16);

  let y = 70;
  content.forEach(line => {
    doc.text(line, 25, y);
    y += 10;
  });

  // р╕ер╕▓р╕вр╣Ар╕Лр╣Зр╕Щр╕ер╣Ир╕▓р╕Зр╕лр╕Щр╣Йр╕▓
  doc.setFontSize(12);
  doc.text("р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕: р╣Ар╕нр╕Бр╕кр╕▓р╕гр╕Щр╕╡р╣Йр╣Ар╕Ыр╣Зр╕Щр╣Ар╕нр╕Бр╕кр╕▓р╕гр╕кр╕│р╕Др╕▒р╕Н р╣Гр╕Кр╣Йр╣Ар╕Юр╕╖р╣Ир╕нр╕Бр╕▓р╕гр╕Вр╕нр╕ер╕Зр╕Щр╕▓р╕бр╕кр╣Ир╕Зр╕Хр╕▒р╕зр╕Эр╕╢р╕Бр╕Зр╕▓р╕Щр╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ", 105, 280, { align: "center" });

  // р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Ф PDF
  doc.save("р╣Ар╕нр╕Бр╕кр╕▓р╕гр╕кр╕│р╕Др╕▒р╕Н_р╕Вр╕нр╕ер╕Зр╕Щр╕▓р╕бр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕Эр╕╢р╕Бр╕Зр╕▓р╕Щ.pdf");
});
